import{_ as R,r as f,h as b,a as o,o as T,c as U,b as t,w as l,e as g,d as I,i as v,m as q,x as B}from"./index.a3059827.js";import{a as F}from"./axios.3a665b0f.js";const N={class:"recharge-card"},j={class:"result-content"},z={__name:"RechargeCard",setup(A){const m=f(null),_=f(!1),r=f(!1),s=b({success:!1,title:"",subTitle:""}),a=b({studentId:"",amount:50,paymentMethod:"alipay"}),x=b({studentId:[{required:!0,message:"请输入学生ID",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],amount:[{required:!0,message:"请输入充值金额",trigger:"blur"},{type:"number",min:1,message:"金额必须大于0",trigger:"blur"}],paymentMethod:[{required:!0,message:"请选择支付方式",trigger:"change"}]}),w=async u=>{u&&await u.validate(async e=>{if(e)try{_.value=!0;const d=await F.put(`http://127.0.0.1:8080/api/v1/cards/student/${a.studentId}/balance`,{amount:a.amount});s.success=!0,s.title="充值成功",s.subTitle=`已成功向学生ID为 ${a.studentId} 的校园卡充值 ¥${a.amount}`,r.value=!0,y(u)}catch(d){s.success=!1,s.title="充值失败",s.subTitle=d.message||"请检查学生ID是否正确",r.value=!0}finally{_.value=!1}})},y=u=>{u&&u.resetFields()};return(u,e)=>{const d=o("el-input"),i=o("el-form-item"),C=o("el-input-number"),p=o("el-option"),h=o("el-select"),V=o("el-icon"),c=o("el-button"),k=o("el-form"),$=o("el-card"),D=o("el-result"),M=o("el-dialog");return T(),U("div",N,[t($,{class:"card-container"},{header:l(()=>e[7]||(e[7]=[g("div",{class:"card-header"},[g("h3",null,"校园卡余额充值")],-1)])),default:l(()=>[t(k,{ref_key:"formRef",ref:m,model:a,rules:x,"label-width":"120px","label-position":"right","status-icon":""},{default:l(()=>[t(i,{label:"学生ID",prop:"studentId"},{default:l(()=>[t(d,{modelValue:a.studentId,"onUpdate:modelValue":e[0]||(e[0]=n=>a.studentId=n),placeholder:"请输入学生ID",clearable:""},null,8,["modelValue"])]),_:1}),t(i,{label:"充值金额",prop:"amount"},{default:l(()=>[t(C,{modelValue:a.amount,"onUpdate:modelValue":e[1]||(e[1]=n=>a.amount=n),min:1,precision:2,step:10,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(i,{label:"支付方式",prop:"paymentMethod"},{default:l(()=>[t(h,{modelValue:a.paymentMethod,"onUpdate:modelValue":e[2]||(e[2]=n=>a.paymentMethod=n),placeholder:"请选择支付方式",style:{width:"100%"}},{default:l(()=>[t(p,{label:"支付宝",value:"alipay"}),t(p,{label:"微信支付",value:"wechat"}),t(p,{label:"银行卡",value:"bank"})]),_:1},8,["modelValue"])]),_:1}),t(i,null,{default:l(()=>[t(c,{type:"primary",onClick:e[3]||(e[3]=n=>w(m.value)),loading:_.value},{default:l(()=>[t(V,null,{default:l(()=>[t(I(q))]),_:1}),e[8]||(e[8]=v("充值 "))]),_:1,__:[8]},8,["loading"]),t(c,{onClick:e[4]||(e[4]=n=>y(m.value))},{default:l(()=>[t(V,null,{default:l(()=>[t(I(B))]),_:1}),e[9]||(e[9]=v("重置 "))]),_:1,__:[9]})]),_:1})]),_:1},8,["model","rules"])]),_:1}),t(M,{modelValue:r.value,"onUpdate:modelValue":e[6]||(e[6]=n=>r.value=n),title:"充值结果",width:"30%",center:""},{default:l(()=>[g("div",j,[t(D,{icon:s.success?"success":"error",title:s.title,"sub-title":s.subTitle},{extra:l(()=>[t(c,{type:"primary",onClick:e[5]||(e[5]=n=>r.value=!1)},{default:l(()=>e[10]||(e[10]=[v("确定")])),_:1,__:[10]})]),_:1},8,["icon","title","sub-title"])])]),_:1},8,["modelValue"])])}}},J=R(z,[["__scopeId","data-v-38e5c2eb"]]);export{J as default};
