import{a as C}from"./axios.3a665b0f.js";import{_ as N,r as f,h as g,a as d,o as w,c as k,b as t,w as s,e as b,i as v,E as p}from"./index.5bfda754.js";const q={class:"create-card"},B={__name:"CreateCard",setup(D){const m=f(null),i=f(!1),a=g({studentId:"",studentName:"",balance:0}),y=g({studentId:[{required:!0,message:"请输入学生ID",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],studentName:[{required:!0,message:"请输入学生姓名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],balance:[{required:!0,message:"请输入初始余额",trigger:"blur"}]}),V=async r=>{r&&await r.validate(async e=>{var u,n;if(e)try{i.value=!0;const l=await C.post("/api/v1/cards",{studentId:a.studentId,studentName:a.studentName,balance:a.balance});l.data.code===200?(p({message:l.data.msg||"校园卡创建成功",type:"success"}),c(r)):p({message:l.data.msg||"校园卡创建失败",type:"error"})}catch(l){p({message:((n=(u=l.response)==null?void 0:u.data)==null?void 0:n.msg)||l.message||"校园卡创建失败",type:"error"})}finally{i.value=!1}})},c=r=>{r&&r.resetFields()};return(r,e)=>{const u=d("el-input"),n=d("el-form-item"),l=d("el-input-number"),_=d("el-button"),I=d("el-form"),x=d("el-card");return w(),k("div",q,[t(x,{class:"card-container"},{header:s(()=>e[5]||(e[5]=[b("div",{class:"card-header"},[b("h3",null,"创建校园卡")],-1)])),default:s(()=>[t(I,{ref_key:"formRef",ref:m,model:a,rules:y,"label-width":"120px","label-position":"right","status-icon":""},{default:s(()=>[t(n,{label:"学生ID",prop:"studentId"},{default:s(()=>[t(u,{modelValue:a.studentId,"onUpdate:modelValue":e[0]||(e[0]=o=>a.studentId=o),placeholder:"请输入学生ID"},null,8,["modelValue"])]),_:1}),t(n,{label:"学生姓名",prop:"studentName"},{default:s(()=>[t(u,{modelValue:a.studentName,"onUpdate:modelValue":e[1]||(e[1]=o=>a.studentName=o),placeholder:"请输入学生姓名"},null,8,["modelValue"])]),_:1}),t(n,{label:"初始余额",prop:"balance"},{default:s(()=>[t(l,{modelValue:a.balance,"onUpdate:modelValue":e[2]||(e[2]=o=>a.balance=o),min:0,precision:2,step:10,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(n,null,{default:s(()=>[t(_,{type:"primary",onClick:e[3]||(e[3]=o=>V(m.value)),loading:i.value},{default:s(()=>e[6]||(e[6]=[v("创建")])),_:1,__:[6]},8,["loading"]),t(_,{onClick:e[4]||(e[4]=o=>c(m.value))},{default:s(()=>e[7]||(e[7]=[v("重置")])),_:1,__:[7]})]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}},$=N(B,[["__scopeId","data-v-d9160cec"]]);export{$ as default};
